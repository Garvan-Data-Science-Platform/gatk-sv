27489.3+51165.26
4415.25+4415.25
4415.25+2737
71153-5730
7153-5730
7152-5730
121*.6*.85
1950*8
59*5
772*2+1
56*4
56*4/(8*4)
?read.table
519*2
128979/129357
73607/129357
length(unique(SVID_stat[SVID_stat[,2]>1,][,1]))
setwd("/Users/xuefangzhao/Google Drive/Talkowski_Lab/HGSV_3/cromwell/gatk-sv-v1/module08/")
dat=read.table('nstd166.GRCh38.variant_call.vcf.gz')
dat[,4]=apply(dat,1,function(x){strsplit(strsplit(as.character(x[8]),';')[[1]][3],'=')[[1]][2]})
dat[,5]=apply(dat,1,function(x){strsplit(strsplit(as.character(x[8]),';')[[1]][2],'=')[[1]][2]})
dat[,6]=apply(dat,1,function(x){strsplit(tail(strsplit(as.character(x[8]),';')[[1]],2)[1],'=')[[1]][2]})
dat[,7]=apply(dat,1,function(x){strsplit(tail(strsplit(as.character(x[8]),';')[[1]],3)[1],'=')[[1]][2]})
dat[,8]=apply(dat,1,function(x){strsplit(tail(strsplit(as.character(x[8]),';')[[1]],1),'=')[[1]][2]})
dat[,1]=paste('chr',dat[,1],sep = '')
dat[,ncol(dat)+1] = apply(dat, 1, function(x){paste(as.character(x[1]),x[2],x[4],x[5],sep = '_')})
SVID_stat=data.frame(table(dat[,ncol(dat)]))
data=dat[dat[,ncol(dat)]%in%SVID_stat[SVID_stat[,2]==1,][,1],]
unique(SVID_stat[SVID_stat[,2]>1,][,1])
length(unique(SVID_stat[SVID_stat[,2]>1,][,1])length())
length(unique(SVID_stat[SVID_stat[,2]>1,][,1]))
for(i in unique(SVID_stat[SVID_stat[,2]>1,][,1])){
print(i)
tmp = dat[dat[,ncol(dat)]==i,]
tmp[1,7]=sum(as.numeric(tmp[,7]))
tmp[1,6]=as.numeric(tmp[1,7])/as.numeric(tmp[1,8])
data[nrow(data)+1,]=tmp[1,]
}
head(dat)
dat[dat[,9]=='chr7_152255110_152255111_INS',]
head(data)
dim(data)
head(data[,c(1,2,4,3,5,6)])
datb=unique(data[,c(1,2,4,3,5,6)])
dim(datb)
write.table(datb, 'nstd166.GRCh38.variant_call.bed', quote = F, sep='\t', col.names = F, row.names = F)
